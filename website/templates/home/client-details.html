{% extends 'layouts/base.html' %}

{% block title %} Clientes {% endblock title %}

{% block content %}

<div class="header bg-primary pb-8">
  <div class="container-fluid">
    <div class="header-body">
      <div class="row align-items-center py-4">
        <div class="col-lg-12 col-7">
          <h6 class="h2 text-white d-inline-block mb-0">Clientes</h6>
          <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
            <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
              <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li>
              <li class="breadcrumb-item"><a href="/">Clientes</a></li>
              <li class="breadcrumb-item active" aria-current="page"> {{ client.name }}</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Page content -->
<div class="container-fluid mt--8">
  <div class="row">
    <div class="col">
    {% include "includes/messages.html" %}
      <div class="card">
        <form method="POST">
          <div class="card-header">
            <div class="row align-items-center">
              <div class="col-1">
                <a class="nav-link active" href="{{ url_for('views.home') }}">
                  <i class="ni ni-bold-left"></i>
                </a>
              </div>
              <div class="col-7">
                <h3 class="mb-0"> {{ client.name }} </h3>
              </div>
              <div class="col-4 text-right">
                <button type="submit" class="btn btn-primary" data-toggle="modal">Salvar</button>
              </div>
            </div>
          </div>
          <div class="card-body">
            <h6 class="heading-small text-muted mb-4">Informações básicas</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-lg-4">
                  <div><h7 class="heading-small text-muted mb-4">Telefone</h7></div>
                  <div>{{ client.phone }}</div>
                </div>
                <div class="col-lg-4">
                  <div><h7 class="heading-small text-muted mb-4">Faturamento declarado</h7></div>
                  <div> R$ {{ "{:.2f}".format(client.income).replace('.', ',') }}</div>
                </div>
                <div class="col-lg-4">
                  <div><h7 class="heading-small text-muted mb-4">Data de cadastro</h7></div>
                  <div> {{ client.registration_date.strftime("%d/%m/%Y") }}</div>
                </div>
              </div>
            </div>
            <hr class="my-4" />
            <!-- Address -->
            <h6 class="heading-small text-muted mb-4">Endereço</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <h7 class="heading-small text-muted mb-4">Logradouro</h7>
                    <div>{{ client.address.street }}</div>
                    
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <h7 class="heading-small text-muted mb-4">Complemento</h7>
                    <div>{{ client.address.complement }}</div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div><h7 class="heading-small text-muted mb-4">Bairro</h7></div>
                  <div>{{ client.address.district }}</div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <h7 class="heading-small text-muted mb-4">Cidade</h7>
                    <div>{{ client.address.city }}</div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-4">
                  <div class="form-group">
                    <h7 class="heading-small text-muted mb-4">Estado</h7>
                    <div>{{ client.address.state }}</div>
                  </div>
                </div>                
                <div class="col-lg-4">
                  <div class="form-group">
                    <h7 class="heading-small text-muted mb-4">CEP</h7>
                    <div>{{ client.address.postal_code }}</div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="form-group">
                    <h7 class="heading-small text-muted mb-4">País</h7>
                    <div>{{ client.address.country }}</div>
                  </div>
                </div>

              </div>
            </div>
            <hr class="my-4" />
            <!-- Description -->
            <h6 class="heading-small text-muted mb-4">Dados bancários</h6>
            <div class="pl-lg-4">
              <div class="col d-flex justify-content-center">
                <div class="col-xl-8 col-md-8 ">
                  <div class="card card-stats">
                    <!-- Card body -->
                    <div class="card-body">
                      
                      {% if client.bankaccount %}
                      <div class="table-responsive">
                        <table class="table align-items-center table-flush">
                          <thead class="thead-light">
                            <tr>
                              <th scope="col" class="sort" data-sort="name">Banco</th>
                              <th scope="col" class="sort" data-sort="phone">Agência</th>
                              <th scope="col" class="sort" data-sort="address">Conta</th>
                              <th scope="col"></th>
                            </tr>
                          </thead>
                          <tbody class="list">
                            {% for client in clients %}
                            <tr>
                              <th scope="row">
                                <div class="media align-items-center">
                                  <div class="media-body">
                                    <span class="name mb-0 text-sm">{{ client.name }}</span>
                                  </div>
                                </div>
                              </th>
                              <td >
                                {{ client.phone }}
                              </td>
                              <td>
                                {{ client.address.street }}
                              </td>
                              <td class="text-right">
                                R$ {{ "{:.2f}".format(client.income).replace('.', ',') }}
                              </td>
                              <td>
                                {{ client.registration_date.strftime("%d/%m/%Y") }}
                              </td>
                              <td class="text-right">
                                <div class="dropdown">
                                  <a class="btn btn-sm btn-icon-only text-light" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fas fa-ellipsis-v"></i>
                                  </a>
                                  <div class="dropdown-menu dropdown-menu-right dropdown-menu-arrow">
                                    <a class="dropdown-item" href="{{ url_for('views.client_update', clientId=client.id) }}" >
                                      <i class="ni ni-settings-gear-65"></i>Editar                                                      
                                    </a>
                                    <a class="dropdown-item" href="#" data-toggle="modal" data-target="#confirmationModal{{client.id}}">
                                      <i class="fa fa-trash"></i>Excluir
                                    </a>
                                    
                                  </div>
                                </div>
                              </td>
                            </tr>
                            <!-- Modal -->
                            <div class="modal fade" id="confirmationModal{{client.id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                              <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Excluir este cliente?</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                      <span aria-hidden="true">&times;</span>
                                    </button>
                                  </div>
                                  <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                    <button type="button" class="btn btn-danger" onClick="deleteClient( '{{ client.id }}' )"> Excluir</button>
                                  </div>
                                </div>
                              </div>
                            </div>
            
            
            
                            {% endfor %}
                          </tbody>
                        </table>
                        
                      </div>
                      {% endif %}
                      <div class="card-footer py-12"></div>
                        <div class="row">
                          <div class="col-lg-4">
                            <div class="form-group">
                              <label class="form-control-label" for="bank">Banco</label>
                              <input type="text" id="bank" name="bank" class="form-control" placeholder="Banco">
                            </div>
                          </div>                
                          <div class="col-lg-4">
                            <div class="form-group">
                              <label class="form-control-label" for="branch">Agência</label>
                              <input type="text" id="branch" name="branch" class="form-control" placeholder="Agência">
                            </div>
                          </div>
                          <div class="col-lg-4">
                            <div class="form-group">
                              <label class="form-control-label" for="account">Conta corrente</label>
                              <input type="text" id="account"  name="account" class="form-control" placeholder="Conta" >
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-lg-12 text-center">
                            <div class="form-group">
                              <button type="submit" class="btn btn-success">Adicionar</button>
                            </div>
                          </div>
                        </div>
                      </div>


                    </div>
                  </div>
                </div>
                <textarea rows="4" class="form-control" placeholder="A few words about you ...">A beautiful Dashboard for Bootstrap 4. It is Free and Open Source.</textarea>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  {% include "includes/footer.html" %}

</div>

{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}{% endblock javascripts %}
